
# デプロイ方法
- クラウドベース
- オンプレミス(プライベートクラウドデプロイ)
- ハイブリッド
    - 先行支出を変動支出に切り替えられる

## クラウドでのコンピューティング
- クラウドベース: 低レベルのインフラストラクチャ上に構築から高レベルのサービスを使用して主要なインフラストラクチャの管理、設計、スケーリングに必要な作業を軽減
- メリット
    - 変動支出へ
データセンターの維持管理不要
キャパシティの予測不要
スケールメリット
スピードと機敏性
グローバル展開
オンプレミス(プライベートクラウド): 仮想化ツールとリソース管理ツールを使用してリソースをデプロイ。アプリケーションかりと仮想化技術を使用してリソースの使用率を向上させる。
ハイブリッドデプロイ: クラウドベースのリソースをオンプレミスのインフラストラクチャに接続。
AWS Outposts: AWSのインフラストラクチャとサービスをオンプレミスのデータセンターに拡張する。
Amazon EC2
Amazon EC2 (Amazon Elastic Compute Cloud): サイズ変更可能で安全なコンピューティングキャパシティーをAmazon EC2 インスタンスとしてクラウド内で提供する。(= VM)
インスタンスの作成: 基本設定を含むテンプレートを選択。インスタンスタイプ(スペック). ネットワークトラフィックの流れを制御するセキュリティ設定を指定。
インスタンスの接続: プログラムとアプリケーションからインスタンスに直接接続してデータをやりとり。コンピュータのデスクトップにログインしてアクセス。
インスタンスの利用
インスタンスタイプ
汎用インスタンス: コンピューティング、メモリ、ネットワークのリソースをバランスよく提供
アプリケーションサーバー
ゲームサーバー
エンタープライズアプリケーションのバックエンドサーバー
小規模及び中規模のデータベース
コンピューティング最適化インスタンス: 高パフォーマンスプロセッサの恩恵を受けることができるアプリケーションに最適。
高性能のwebサーバー
計算負荷の高いアプリケーションサーバー
専用のゲームサーバー
メモリ最適化インスタンス: メモリ内にロードした大規模なデータセットを処理するワークロードに対して高速なパフォーマンスを実現するように設計
メモリは一時的なストレージ領域。CPUがアクションを完了するために必要な全てのデータと命令を保持。コンピュータプログラムやアプリケーションはストレージからメモリにロードされた後に実行可能。このプリロードプロセスによってCPUからコンピュータプログラムへの直接アクセスが可能になる。アプリケーション実行前に大量のデータをメモリに読み込む必要があるワークロードがあるとする。その場合、高パフォーマンスのDBや大量な飛行増加データをリアルタイムで処理するワークロードなどがある。このようなユースケースにおいて、メモリ最適化インスタンスの使用を検討。
高速コンピューティングインスタンス: ハードウェアアクセラレーターや子プロセッサーを使用して一部の機能をCPUで実行中のソフトウェアよりも効率的に実行。浮動小数点数計算、グラフィックス処理、データパターン照合などがある。
グラフィックアプリケーション
ゲームストリーミング
アプリケーションストリーミング
ストレージ最適化インスタンス: ローカルストレージの大規模なデータセットに対する高速シーケンシャル読み取り及び、書き込みのアクセスを必要とするワークロード用に設計されている。高いIOPS(Input/Output Operations per second, ストレージデバイスのパフォーマンスを測定するメトリクス。)
分散ファイルシステム
データウェアハウジングアプリケーション
高頻度のオンライントランザクション処理システム

Amazon EC2の料金
オンデマンドインスタンス: 中断できない不規則で短期的なワークロードに最適。
初期費用や最低料金は発生しない。
ユーザーがインスタンスを停止するまでインスタンスは継続的に実行される。
使用したコンピューティング時間に対して料金支払い。
アプリケーションの開発とテスト
使用パターンが予測不可能なアプリケーションの実行
Amazon EC2 Savings Plans: 一定のコンピューティング使用量を1年または3年の期間で契約することでコンピューティング料金を削減。契約した使用料に達するまでは割引が適用されたSavings Plans料金で課金される。契約した使用量を超えた分についてはオンデマンドで課金。
リザーブドインスタンス: オンデマンドインスタンスの利用に適用される割引。1年または3年契約。
期間終了後もAmazon EC2インスタンスは中断することなく使用可能
スポットインスタンス: 開始時刻と終了時刻が定まっていないワークロードや中断可能なワークロードに最適。未使用のAmazon EC2コンピューティングキャパシティーを使用することでコストを抑える。
必要に応じて開始及び停止可能なバックグラウンド処理のジョブがあるとする。Amazon EC2のキャパシティーに空きがない場合、空きができるまでリクエストは成功しない。キャパシティーが利用できないことでバックグラウンド処理ジョブの開始が遅れる可能性がある。
Dedicated Hosts: クライアント専用のAmazon EC2インスタンスキャパシティーを備えた物理サーバー。
ソケット単位、コア単位、またはVM単位の既存のソフトウェアライセンスを使用してライセンス要件を満たす。
Amazon EC2 Auto Scaling
アプリケーションの需要の変化に応じてEC2インスタンスを自動的に作成または削除することが可能。EC2インスタンスの自動的なスケールイン及びスケールアウトによりアプリケーションの可用性をさらに高めることができる。
動的スケーリング: 変化する需要に対応
予測スケーリング: 予測された需要に基づいて適切な数のEC2インスタンスを自動的に用意
Auto Scaling機能
最小キャパシティー: Auto Scalingグループの作成後、すぐに作成されるEC2インスタンスの数
必要なキャパシティ: デフォルトでは最小キャパシティーの数に設定
最大キャパシティ: Auto Scallingグループを需要の増加に応じてスケールアウトするように設定。

Elastic Load Balancing
Elastic Load Balancing: アプリケーションへのトラフィックをEC2インスタンスなどのリソースへ自動的に分散するサービス。ロードバランサーがリクエストを受け取り、受信トラフィックの量に応じて複数のEC2インスタンスにリクエストを分散する。Elastic Load Balancing とAmazon EC2 Auto Scaling は異なるサービスだが、連携可能




モノリシックアプリケーションとマイクロサービス
モノリシックアプリケーション: コンポーネント同士が密結合になったアプリケーションがあり、これらのコンポーネントにはDB、サーバー、ユーザーインターフェース、ビジネスロジックなどがある。一つのコンポーネントで障害が発生すると他のコンポーネントでも障害が発生し、全体での障害発生につながる。
マイクロサービス: アプリケーションが疎結合されており、一つのコンポーネントで障害が発生しても、他のコンポーネントは引き続き機能する。
Amazon Simple Notification Service (Amazon SNS): Pub/Subサービス。パブリッシャーはAmazon SNSトピックを使用してサブスクライバーにメッセージを発行できる。(Publisher to web servers, e-mail address, or AWS Lambda関数)
Amazon Simple Queue Service (Amazon SQS): メッセージキューイングサービス。ソフトウェアコンポーネント間でメッセージを送信、保存、受信可能。アプリケーションからキューにメッセージを送信。ユーザーまたはサービスはキューからメッセージを受信して処理した後キューからメッセージを削除


サーバーレスコンピューティング
Amazon EC2で実行するアプリケーションがある場合
インスタンス(仮想サーバー)をプロビジョニング
コードをアップロード
アプリケーションの実行中、インスタンスを管理し続ける。

AWS Lambda
AWS Lambda: サーバーのプロビジョニングや管理を行うことなくコードを実行できるサービス (Azure Functions)
使用したコンピューティング時間に対してのみ料金が発生する。
課金されるのはコードが実行されている時のみ
ほぼ全ての種類のアプリケーションやバックエンドサービスのコードを管理作業を行うことなく実行可能


コンテナ
コンテナ: アプリケーションのコードや依存関係を一つのオブジェクトにパッケージ化する技術。セキュリティ、信頼性、スケーラビリティに関する必須要件があるプロセスやワークフローに使用
Amazon Elastic Container Service (Amazon ECS)
Amazon ECS: スケーラビリティとパフォーマンスに優れたコンテナ管理システム。コンテナ化されたアプリケーションをAWSで実行及びスケール可能。
Dockerコンテナをサポート。オープンソースのDocker Community Edition とサブスクリプションベースのDocker Enterprise Editionをサポート。APIコールを使用してDockerコンテナを起動及び停止できる。
コンテナ: アプリケーションのコードや依存関係を1つのオブジェクトにパッケージ化する技術。またセキュリティ、信頼性、スケーラビリティに関する必須要件があるプロセスやワークフローに使用可能。

Amazon Elastic Kubernetes Service (Amazon EKS)
Amazon EKS: AWSでKubernetesを実行できるフルマネージドサービス。
Kubernetes: コンテナ化されたアプリケーションを大規模にデプロイして管理できるOSS。コンテナ仮想化ソフトウェア(Dockerなど)を管理、及び自動化するためのOSS。複数のコンテナを連携して管理する強み

AWS Fargate
AWS Fargate: コンテナ向けのサーバーレスコンピューティングエンジン。
Amazon ECSとAmazon EKSの両方で利用可能。
AWS Fargateを使用することでサーバーのプロビジョニングや管理を行う必要がない。
料金はコンテナの実行に必要なリソースに対してのみ発生。

グローバルインフラストラクチャと信頼性
AWS グローバルインフラストラクチャ
リージョンの選択: 複数のビジネス要素を考慮
データガバナンスと法的要件の遵守
ユーザーとの近接性
リージョン内で利用可能なサービス
料金
アベイラビリティゾーン: リージョン内の1つのデータセンタまたはデータセンターのグループで構成されている。互いに数十マイル離れている。
低レイテンシー(コンテンツがリクエストされてから受信されるまでの時間)を実現
エッジロケーション: Amazon CloudFrontでコンテンツのキャッシュされたコピーをクライアントの近くに保存するために使用する場所。
オリジン: Amazon EC2インスタンスを保持するリージョン
Amazon CloudFront: コンテンツ配信サービス。エッジロケーションのキャッシュからデータを取得し、クライアントに送信。コンテンツがキャッシュされるとコピーとしてローカルに保存。


AWSリソースをプロビジョニング
AWSマネジメントコンソール: AWSのサービスにアクセスし、サービスを管理するためのWebベースのインターフェース。コンソールには、タスクを完了するプロセスを簡素化できるウィザードと自動化されたワークフローが用意されている。(Azure portal)
リソースのモニタリング、アラームの表示、請求情報の確認など
ウィザード: 利用者に一つずつ質問や設定項目を提示して選択や入力を促し、対話的に処理する。
AWS CloudFormation: インフラストラクチャをコードとして扱う。AWS マネジメントコンソールはリソースを個別にプロビジョニングする代わりにコード行を記述して環境を構築。
AWS Elastic Beanstalk: ユーザーがコードと設定情報を提供することによってタスクの実行に必要なリソースが自動的にデプロイされる
キャパシティーの調整
負荷分散
自動スケーリング
アプリケーション状態のモニタリング
AWSコマンドラインインターフェース: AWSのサービスとアプリケーションのアクションをスクリプトで自動化するために使用。APIリクエストを作成する際の時間を短縮。AWSの複数のサービスを制御可能。
SDK (ソフトウェア開発キット): サポートされているプログラミング言語を使用してAWSでアプリケーションを開発。AWSのサービスにアクセスしてサービスを管理する。プログラミング言語やプラットフォーム用に設計されたAPIを使用してASWのサービスを簡単に使用できる。

ネットワーク
Amazon Virtual Private Cloud: AWSリソースに対する境界を確立するために使用できるネットワークサービス。AWSクラウドに独立したセクションをプロビジョニングできる。この独立したセクションにおいて定義した仮想ネットワークの中にリソースを機動。Virtual Private Cloud 内ではリソースをサブネットに整理。
サブネット: リソースをグループ化するために使用する個別の領域。VPCの一部分であり、Amazon EC2インスタンスなどのリソースをその中に配置
パブリック/プライベート両方を選択可能。サブネットは相互に通信可能。
パブリックサブネット: オンラインストアのウェブサイトなど一般公開されているリソースが含まれる。
プライベートサブネット: 顧客の個人情報や注文履歴を含むデータベースなどプライベートネットワークを介してのみアクセス可能なリソース。
インターネットゲートウェイ: インターネットからのパブリックトラフィックをVPCに渡すため。

仮想プライベートゲートウェイ: 保護されたインターネットトラフィック(VPN)をVPCで受け付けるようにするためのコンポーネント。VPCへのトラフィックが許可されるのは承認されたネットワークからのトラフィックのみ。

VPN: 周辺の他のリクエスト全てに対しインターネットトラフィックを暗号化
AWS Direct Connect: データセンターとVPCの間に専用のプライベート接続を確立できるサービス。

ネットワークコストを削減したり、ネットワークを通る帯域幅を増やしたりできる。
帯域幅: 事実上の通信速度の上限。帯域幅が広いと一度に送信できるデータの量が多くなるため同じデータ量でもやりとりに時間が短くて済む

VPC内のネットワークトラフィック
パケットはインターネットゲートウェイを介してVPCに送信。パケットがサブネットに出入りする前にアクセス許可がチェック。アクセス許可にはパケットの送信者、パケットからのサブネット内のリソースへの通信方法が示される。
ネットワークアクセスコントロールリスト: サブネットレベルでインバウンドドラフィックとアウトバウンドトラフィックを制御する仮想ファイアウォール。
VPCを設定する際はアカウントのデフォルトのネットワークACLを使うかカスタムネットワークACLを使う。
デフォルト:全てのインバウンドトラフィックとアウトバウンドトラフィックを許可
カスタムネットワーク: 許可するトラフィックを指定するルールを追加するまでは全てのインバウンドトラフィックとアウトバウンドトラフィックが拒否される。

ステートレスパケットフィルタリング: ネットワークACLではステートレスパケットフィルタリングが実行。処理情報が保存されないためパケットはサブネットの境界を出入りするたびにチェック
セキュリティグループ: Amazon EC2インスタンスのインバウンドトラフィックとアウトバウンドトラフィックを制御する仮想ファイアウォール。
デフォルトでは全てのインバウンドトラフィックを拒否し、全てのアウトバウンドトラフィックを許可。カスタムルールを追加して、許可または拒否するトラフィックを設定できる。
サブネット内にAmazon EC2インスタンスが複数ある場合はインスタンスを同じセキュリティグループに関連づけることもインスタンスごとに異なるセキュリティグループを使用することもできる。
ステートフルパケットフィルタリング: 受信パケットに対して行われた以前の処理情報は保存されている。
リクエストの情報がセキュリティグループに保存されている。

クライアント→インターネット→AWSクラウド(->VPC(インターネットゲートウェイ(ネットワークアクセスコントロールリスト[ステートレスフィルタリング](->セキュリティグループ[ステートフルフィルタリング](->Amazon EC2))))))

グローバルネットワーク
DNS: DNSはインターネットで電話帳と同じ役割を果たす。DNS解決はドメイン名をIPアドレスに変換するプロセス。
Amazon Route 53: DNSウェブサービス。AWSでホストされているインターネットアプリケーションにエンドユーザーをルーティングするための信頼性の高い方法を開発者とビジネスに提供。
ユーザーからのリクエストをインフラストラクチャにルーティング
ドメイン名のDNSレコードを管理。ユーザーは新しいドメイン名をRoute 53に直接登録可能。また他のドメインレジストラで管理されている既存のドメイン名のDNSレコードを転送することも可能。

クライアントがアプリケーションのデータをリクエスト(URL)→Amazon Route 53→IPアドレス→クライアント）→Amazon CloudFront

ストレージ
インスタントストア: Amazon EC2インスタンスのブロックレベルの一時ストレージを提供。EC2インスタンスのホストコンピュータに物理的に付属しているディスクストレージであるため存続期間がそのインスタンスと同じ。長期的には必要のない一時的なデータを処理するユースケース
Amazon Elastic Block Store: Amazon EC2インスタンスで使用できるブロックレベルのストレージボリュームを提供する。Amazon EC2インスタンスが停止または削除されても付属したEBSボリュームのすべてのデータは使用可能
作成: 構成(ボリュームサイズやタイプなど)を定義してプロビジョニング。作成後Amazon EC2インスタンスに付属
Amazon EBSスナップショット: 増分バックアップ
増分バックアップ: 1回目のボリュームバックアップではすべてのデータがコピーされる。それ以降のバックアップでは最新のスナップショット以降に変更されたデータのブロックのみが保存。
ブロックストレージ内のファイルの変更: 変更した部分のみ更新
1つのアベイラビリティゾーンにデータを保存
Amazon EC2インスタンスとEBSボリュームの両方が同じアベイラビリティゾーンにいる必要がある。
Amazon Simple Storage Service (Amazon S3): オブジェクトレベルのストレージを提供するサービス。データをオブジェクトとしてバケットに保存。
オブジェクトストレージ: 各オブジェクトはデータ、メタデータ、キーで構成
データ: 画像、動画、テキスト文章、その他の種類のファイル
メタデータ: データの種類、使用方法、オブジェクトサイズなどの情報
オブジェクトキー: 一意の識別子
オブジェクトストレージ内のファイルを変更するとオブジェクト全体が更新
ストレージ容量: 無制限
最大のファイルサイズ: 5TB
セキュリティ: Amazon S3にファイルをアップロードするときにそのファイルの可視性とアクセスを制御するアクセス許可を設定。バージョニング機能を使用して
ストレージクラス: 実際に使用した分のみ料金が発生。
Amazon S3ストレージクラスを選択するときは２つの要素を考慮。
データ取得の頻度
データ可用性の要件
種類
S3標準: 高可用性のあるオブジェクトを提供
頻繁にアクセスされるデータ用の設計
最低３つのアベイラビリティゾーンにデータを保存
S3標準-IA: アクセス頻度が低いものの必要な時にすぐに使用できる高可用性が求められるデータに適する。
アクセス頻度の低いデータに最適
S3標準に似ているがストレージ料金が低く取り出し料金が高い
S3 1ゾーン-IA: S3-IAのアベイラビリティゾーンが1個のバージョン
1つのアベイラビリティゾーンにデータを保存
S3-IAよりも低いストレージ料金
S3 Intelligent-Tiering: Amazon S3によってオブジェクトのアクセスパターンがモニタリングされる。30日間連続してアクセスがないオブジェクトはAmazon S3によって低頻度アクセス階層であるS3-IAに自動的に移動。低頻度アクセス階層のオブジェクトにアクセスがあると、オブジェクトはAmzon S3によって自動的に高頻度アクセス階層であるS3標準に移動される。
S3 Glacier: データアーカイブに最適な低コストのストレージクラス。
データアーカイブ用に設計された低コストのストレージ
数分から数時間以内にオブジェクトを取得可能
S3 Glacier Deep Archive: 最も低コストなストレージクラス
最も低コストのオブジェクトストレージクラスでアーカイブに最適
12時間以内にオブジェクトを取得可能
オブジェクトストレージVSブロックストレージVSファイルストレージ
ファイルストレージ: 複数のクライアント(ユーザー、アプリケーション、サーバー)が、共有ファイルフォルダに保存されているデータにアクセス。ブロックストレージ+ローカルファイルシステム。クライアントはファイルパスを使ってデータにアクセス
ユースケース: 多数のサービスとリソースが同時に同じデータにアクセスする必要がある
クラウド間での共通点
複数のユーザーの同時アクセスが可能
スケーラビリティ
クラウド間での相違点
EFS: scalable cloud-based file storage service
SharePoint: a comprehensive collaboration / content management. Workflow automation capabilities
オブジェクトストレージ: オブジェクト単位で利用可能。
ユースケース: 大規模データの管理、Webコンテンツの配置先
ブロックストレージ: ブロック単位、I/O速度が速い
プログラムを使った演算、業務処理
更新する頻度が高いデータの入出力
Amazon Elastic File System: AWSクラウドサービスとオンプレミスのリソースで使用できるスケーラブルなファイルシステム。ファイルを追加または削除するとAmazon EFSは自動的に拡張および縮小される。アプリケーションを中断することなくオンデマンドでペタバイト規模までスケールできる。
複数のアベイラビリティゾーンにデータを保存。重複されたストレージ環境によりファイルシステムがあるリージョン内のすべてのアベイラビリティゾーンから同時にデータにアクセス可能。オンプレミスサーバーはAWS Direct Connectを使用してAmazon EFSにアクセス可能
Amazon Relational Database: AWSクラウドでリレーショナルデータベースを実行するサービス。ハードウェアのプロビジョニング、データベースのセットアップ、パッチ適用、バックアップなどのタスクを自動化するマネージドサービス。
リレーショナルデータベース: データは他のデータに関連づけられて保存
構造化クエリ言語(SQL)を使用してデータの保存及びクエリを実行
データを簡単に把握し、一貫性を保ち、スケーラブルな方法で保存
データベースエンジン: メモリ、パフォーマンス、入出力(I/O)を最適化する6つのデータベースエンジンを活用
Amazon Aurora: エンタープライズ規模のリレーショナルデータベース。
MySQL及びPostgreSQLのリレーショナルデータベースと互換性あり。
標準のMySQLのデータベースよりも最大5倍、標準のPostgreSQLデータベースよりも最大3倍高速。
不要なI/Oオペレーションを減らすことでデータベースコストを削減しつつ、データベースリソースの信頼性と可用性を確保
3つのアベイラビリティゾーン間にデータのコピーを6つ作成してレプリケートし、データをAmazon S3にバックアップする
PostgreSQL
MySQL
MariaDB
Oracleデータベース
Microsoft SQL Server
Amazon DynamoDB: キーバリューデータサービス。あらゆる規模で1桁msパフォーマンスを提供
非リレーショナルデータベース: テーブルを作成。テーブルではデータの保存やクエリを実行できる。
行と列以外の構造を使用してデータを整理するためNoSQLデータベースとも呼ばれる。
非リレーショナルデータベースの構造的アプローチの1つとしてキーバリューペアがある。

サーバーレス: サーバーのプロビジョニング、パッチ適用、管理を行う必要はない。またソフトウェアのインストール、保守、操作を行う必要はない
自動スケーリング: データベースのサイズが縮小または拡大するとDynamoDBは自動駅にスケーリングされ一貫性を保ちつつ容量の変化に合わせて調整される。
リレーショナルデータベースVS非リレーショナルデータベース
リレーショナルデータベース: 複雑なリレーショナル結合が必要な時
SQLを使用してデータを整理
Amazon Auroraデータベースにデータを保存
非リレーショナルデータベース: 複雑なリレーショナル結合が不要な時。高速で大量の情報を処理
サーバーレスデータベースを実行
キーバリューデータベースにデータを保存
1日あたり大量のリクエストまでスケーリングする
Amazon Redshift: ビックデータ分析に使用できるデータウェアハウジングサービス。多くのソースからデータを収集しデータ全体の関係性や傾向を理解するのに役立つ機能
AWS Database Migration Service: リレーショナルデータベース、非リレーショナルデータベース、及びその他のタイプのデータベースを移行できる。
開発及びテスト環境でのデータベース移行
データベースの統合
継続的なレプリケーション
Amazon DocumentDB
Amazon Neptune
Amazon Quantum Ledger Database
Amazon Managed Blockchain
Amazon ElastiCache
Amazon DynamoDB Accelerator
